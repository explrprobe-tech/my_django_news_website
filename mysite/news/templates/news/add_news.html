{% extends "news/base.html" %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å - –ù–æ–≤–æ—Å—Ç–Ω–æ–π —Å–∞–π—Ç{% endblock %}

{% block extra_css %}
<style>
    .add-news-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .add-news-header {
            text-align: center;
            color: white;
            font-size: 1.5rem;
            margin-bottom: 20px;
            font-weight: 700;
            
            /* –¢–û–ù–ö–ê–Ø –ë–ï–õ–ê–Ø –û–ë–í–û–î–ö–ê */
            text-shadow: 
                1.5px 1.5px 2px rgba(0, 0, 0, 0.8),
                -1px -1px 0 rgba(255, 255, 255, 0.3),
                1px -1px 0 rgba(255, 255, 255, 0.3),
                -1px 1px 0 rgba(255, 255, 255, 0.3),
                1px 1px 0 rgba(255, 255, 255, 0.3),
                
                /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ */
                0 0 20px rgba(255, 255, 255, 0.1),
                0 0 40px rgba(255, 255, 255, 0.05);
            
            position: relative;
            z-index: 2;
            letter-spacing: 0.5px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –º–µ–∂–±—É–∫–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ */
    }
    
    .add-news-header p {
        color: #ffffff;
        font-size: 1.4rem;
    }

    .white-shadow {
        text-shadow: 
                1.5px 1.5px 2px rgba(255, 255, 255, 0.8),
                -1px -1px 0 rgba(255, 255, 255, 0.3),
                1px -1px 0 rgba(255, 255, 255, 0.3),
                -1px 1px 0 rgba(255, 255, 255, 0.3),
                1px 1px 0 rgba(255, 255, 255, 0.3),
                
                /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ */
                0 0 20px rgba(255, 255, 255, 0.1),
                0 0 40px rgba(255, 255, 255, 0.05);
    }
    
    /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–∏ */
    .news-form {
            text-align: center;
            color: white;
            font-size: 1.5rem;
            margin-bottom: 20px;
            font-weight: 700;
            
            /* –¢–û–ù–ö–ê–Ø –ë–ï–õ–ê–Ø –û–ë–í–û–î–ö–ê */
            text-shadow: 
                1.5px 1.5px 2px rgba(0, 0, 0, 0.8),
                -1px -1px 0 rgba(255, 255, 255, 0.3),
                1px -1px 0 rgba(255, 255, 255, 0.3),
                -1px 1px 0 rgba(255, 255, 255, 0.3),
                1px 1px 0 rgba(255, 255, 255, 0.3),
                
                /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ */
                0 0 20px rgba(255, 255, 255, 0.1),
                0 0 40px rgba(255, 255, 255, 0.05);
            
            position: relative;
            z-index: 2;
            letter-spacing: 0.5px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –º–µ–∂–±—É–∫–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ */
            background: 
                /* –¢–µ–∫—Å—Ç—É—Ä–∞ —Å—Ç–µ–∫–ª–∞ */
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                /* –û—Å–Ω–æ–≤–Ω–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */
                linear-gradient(135deg, 
                    rgba(255,255,255,0.2) 0%, 
                    rgba(255,255,255,0.05) 50%,
                    rgba(255,255,255,0.1) 100%);
            
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid rgba(255, 255, 255, 0.5);
            border-left: 2px solid rgba(255, 255, 255, 0.5);
            
            box-shadow:
                0 20px 40px rgba(0, 0, 0, 0.25),
                inset 0 2px 0 rgba(255, 255, 255, 0.4),
                inset 0 -2px 0 rgba(0, 0, 0, 0.1),
                inset 2px 0 0 rgba(255, 255, 255, 0.2),
                inset -2px 0 0 rgba(255, 255, 255, 0.2);
                padding: 20px;
                border-radius: 30px;
    }
    
    .form-group {
        margin-bottom: 25px;
        position: relative;
    }
    
    .form-group label {
        color: white;
        display: block;
        margin-bottom: 10px;
        font-weight: 600;
        font-size: 1.1rem;
        text-shadow: 2px 2px 2px rgba(0,0,0,0.8);
        letter-spacing: 0.5px;
    }
    
    .form-group label i {
        margin-right: 8px;
        color: #ffaa00;
    }
    
    .form-control {
        width: 100%;
        padding: 15px 20px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        background: rgba(0, 0, 0, 0.3);
        color: rgb(255, 255, 255);
        backdrop-filter: blur(5px);
        font-size: 1rem;
        transition: all 0.3s ease;
        font-family: 'Arial', sans-serif;
    }
    
    .form-control:focus {
        outline: none;
        border-color: #ffaa00;
        background: rgba(0, 0, 0, 0.4);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(255, 170, 0, 0.2);
    }
    
    .form-control::placeholder {
        color: rgba(255, 255, 255, 0.5);
        font-style: italic;
    }
    
    textarea.form-control {
        min-height: 150px;
        resize: vertical;
    }
    
    /* –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
    .category-select {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 10px;
    }
    
    .category-option {
        background: rgba(0, 0, 0, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        padding: 12px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        color: white;
    }
    
    .category-option:hover {
        border-color: #ffaa00;
        transform: translateY(-3px);
        background: rgba(255, 170, 0, 0.1);
    }
    
    .category-option.selected {
        border-color: #ffaa00;
        background: rgba(255, 170, 0, 0.2);
        box-shadow: 0 5px 15px rgba(255, 170, 0, 0.3);
    }
    
    .category-option input[type="radio"] {
        display: none;
    }
    
    .category-option i {
        font-size: 1.5rem;
        display: block;
        margin-bottom: 5px;
    }
    
    /* –ö–Ω–æ–ø–∫–∏ —Ñ–æ—Ä–º—ã */
    .form-actions {
        display: flex;
        gap: 20px;
        margin-top: 40px;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .btn-submit {
        background: linear-gradient(45deg, #ffaa00, #ff4757);
        color: white;
        border: none;
        padding: 15px 40px;
        border-radius: 30px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.3);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        position: relative;
        overflow: hidden;
    }
    
    .btn-submit::before {
        content: '‚ú®';
        position: absolute;
        left: -20px;
        top: 50%;
        transform: translateY(-50%);
        transition: left 0.3s ease;
    }
    
    .btn-submit:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(255, 170, 0, 0.4);
    }
    
    .btn-submit:hover::before {
        left: 20px;
    }
    
    .btn-cancel {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        padding: 15px 40px;
        border-radius: 30px;
        font-size: 1.1rem;
        font-weight: bold;
        text-decoration: none;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
    }
    
    .btn-cancel:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-3px);
        border-color: #ff4757;
    }
    
    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading-indicator {
        display: none;
        text-align: center;
        margin: 20px 0;
    }
    
    .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-top: 4px solid #ffaa00;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ - WITH WHITE TEXT SHADOW */
    .hint-text {
        color: #4fa8f6;
        font-size: 0.9rem;
        margin-top: 5px;
        display: flex;
        align-items: center;
        gap: 5px;
        
        /* WHITE TEXT SHADOW */
        text-shadow: 
            2px 2px 2px rgba(255, 255, 255, 0.8),
            -1px -1px 0 rgba(255, 255, 255, 0.3),
            1px -1px 0 rgba(255, 255, 255, 0.3),
            -1px 1px 0 rgba(255, 255, 255, 0.3),
            1px 1px 0 rgba(255, 255, 255, 0.3);
    }
    
    .hint-text i {
        color: #ffaa00;
    }
    
    /* –û—à–∏–±–∫–∏ */
    .errorlist {
        color: #ff4757;
        list-style: none;
        padding: 10px;
        margin: 10px 0;
        background: rgba(255, 71, 87, 0.1);
        border-radius: 10px;
        border-left: 4px solid #ff4757;
    }
    
    .errorlist li {
        margin: 5px 0;
    }
    
    @media (max-width: 768px) {
        .add-news-header h1 {
            font-size: 2rem;
            padding: 15px 25px;
        }
        
        .news-form {
            padding: 25px;
        }
        
        .form-actions {
            flex-direction: column;
        }
        
        .btn-submit, .btn-cancel {
            width: 100%;
            text-align: center;
        }
        
        .category-select {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="add-news-container">
    <div class="add-news-header">
        <h1>üìù –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å</h1>
        <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —Å —á–∏—Ç–∞—Ç–µ–ª—è–º–∏</p>
    </div>
    
    <div class="news-form">
        <form method="post" enctype="multipart/form-data" id="addNewsForm">
            {% csrf_token %}
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏ -->
            <div class="form-group">
                <label for="id_title">
                    <i>üì∞</i> –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏
                </label>
                <input type="text" 
                       name="title" 
                       id="id_title" 
                       class="form-control" 
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏..."
                       value="{{ form.title.value|default:'' }}"
                       required>
                <div class="hint-text">
                    <i>üí°</i> –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∞—Ç–∫–∏–º –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º
                </div>
                {% if form.title.errors %}
                <ul class="errorlist">
                    {% for error in form.title.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
            <div class="form-group">
                <label for="id_category">
                    <i>üìå</i> –ö–∞—Ç–µ–≥–æ—Ä–∏—è
                </label>
                <select name="category" id="id_category" class="form-control">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é...</option>
                    {% for category in categories %}
                    <option value="{{ category.id }}" {% if form.category.value == category.id %}selected{% endif %}>
                        {{ category.title }}
                    </option>
                    {% endfor %}
                </select>
                <div class="hint-text">
                    <i>üí°</i> –í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                </div>
                {% if form.category.errors %}
                <ul class="errorlist">
                    {% for error in form.category.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            
            <!-- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
            <div class="form-group">
                <label for="id_short_description">
                    <i>üìã</i> –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
                </label>
                <textarea name="short_description" 
                          id="id_short_description" 
                          class="form-control" 
                          placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)...">{{ form.short_description.value|default:'' }}</textarea>
                <div class="hint-text">
                    <i>üí°</i> –≠—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ –Ω–æ–≤–æ—Å—Ç–µ–π
                </div>
                {% if form.short_description.errors %}
                <ul class="errorlist">
                    {% for error in form.short_description.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            
            <!-- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç -->
            <div class="form-group">
                <label for="id_content">
                    <i>üìÑ</i> –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏
                </label>
                <textarea name="content" 
                          id="id_content" 
                          class="form-control" 
                          placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏..."
                          required>{{ form.content.value|default:'' }}</textarea>
                <div class="hint-text">
                    <i>üí°</i> –ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ —Å–æ–±—ã—Ç–∏–µ, –¥–æ–±–∞–≤—å—Ç–µ –¥–µ—Ç–∞–ª–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
                </div>
                {% if form.content.errors %}
                <ul class="errorlist">
                    {% for error in form.content.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            
            <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
            <div class="form-group">
                <label for="id_image">
                    <i>üñºÔ∏è</i> –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                </label>
                <input type="file" 
                       name="photo" 
                       id="id_image" 
                       class="form-control" 
                       accept="image/*">
                <div class="hint-text">
                    <i>üí°</i> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 1200x630px. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5MB
                </div>
                {% if form.photo.errors %}
                <ul class="errorlist">
                    {% for error in form.photo.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            
            <!-- –¢–µ–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
            <div class="form-group">
                <label for="id_tags">
                    <i>üè∑Ô∏è</i> –¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
                </label>
                <input type="text" 
                       name="tags" 
                       id="id_tags" 
                       class="form-control" 
                       placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –Ω–∞—É–∫–∞, –∫–æ—Å–º–æ—Å"
                       value="{{ form.tags.value|default:'' }}">
                <div class="hint-text">
                    <i>üí°</i> –¢–µ–≥–∏ –ø–æ–º–æ–≥—É—Ç —á–∏—Ç–∞—Ç–µ–ª—è–º –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏
                </div>
                {% if form.tags.errors %}
                <ul class="errorlist">
                    {% for error in form.tags.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div class="form-actions">
                <button type="submit" class="btn-submit">
                    ‚ú® –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å
                </button>
                <a href="{% url 'home' %}" class="btn-cancel">
                    ‚ùå –û—Ç–º–µ–Ω–∞
                </a>
            </div>
            
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="loading-indicator" id="loadingIndicator">
                <div class="spinner"></div>
                <p style="color: white;">–ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–∏...</p>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('addNewsForm');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const submitBtn = document.querySelector('.btn-submit');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã
    form.addEventListener('submit', function(e) {
        submitBtn.disabled = true;
        loadingIndicator.style.display = 'block';
    });
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã
    const formControls = document.querySelectorAll('.form-control');
    formControls.forEach(input => {
        input.addEventListener('focus', function() {
            this.parentElement.style.transform = 'scale(1.02)';
        });
        
        input.addEventListener('blur', function() {
            this.parentElement.style.transform = 'scale(1)';
        });
    });
    
    // –ü–æ–¥—Å—á–µ—Ç —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
    const titleInput = document.getElementById('id_title');
    if (titleInput) {
        const hint = titleInput.parentElement.querySelector('.hint-text');
        titleInput.addEventListener('input', function() {
            const count = this.value.length;
            if (count > 0) {
                hint.innerHTML = `<i>üìä</i> ${count} —Å–∏–º–≤–æ–ª–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 30-100)`;
                if (count < 30) {
                    hint.style.color = '#ff4757';
                } else if (count > 100) {
                    hint.style.color = '#ffaa00';
                } else {
                    hint.style.color = '#2ecc71';
                }
            }
        });
    }
    
    // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    const imageInput = document.getElementById('id_image');
    if (imageInput) {
        imageInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.createElement('div');
                    preview.innerHTML = `
                        <div style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                            <p style="color: #2ecc71;">‚úì –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–æ: ${imageInput.files[0].name}</p>
                            <img src="${e.target.result}" style="max-width: 200px; border-radius: 10px; border: 2px solid #ffaa00;">
                        </div>
                    `;
                    
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –ø—Ä–µ–≤—å—é, –µ—Å–ª–∏ –µ—Å—Ç—å
                    const oldPreview = imageInput.parentElement.querySelector('.image-preview');
                    if (oldPreview) {
                        oldPreview.remove();
                    }
                    
                    preview.classList.add('image-preview');
                    imageInput.parentElement.appendChild(preview);
                };
                reader.readAsDataURL(this.files[0]);
            }
        });
    }
});
</script>
{% endblock %}